<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploying RHEL worker nodes | Red Hat OpenShift on HPE SimpliVity</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/OpenShift-on-SimpliVity/assets/css/0.styles.10caf491.css" as="style"><link rel="preload" href="/OpenShift-on-SimpliVity/assets/js/app.40e23d52.js" as="script"><link rel="preload" href="/OpenShift-on-SimpliVity/assets/js/2.1dbc2e0f.js" as="script"><link rel="preload" href="/OpenShift-on-SimpliVity/assets/js/54.2f275aa2.js" as="script"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/10.1f1d7f8e.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/11.11823b45.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/12.89cf306a.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/13.04e66138.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/14.117c52af.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/15.2b6725ef.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/16.f6c4226c.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/17.e2c26612.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/18.3f1906fb.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/19.c95e0f53.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/20.97be3970.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/21.b83682e9.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/22.2335fd4f.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/23.e7720519.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/24.81a433f1.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/25.bb8e22b0.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/26.501cade6.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/27.a7511174.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/28.5bc43de6.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/29.34bd11fa.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/3.50c5b2bc.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/30.bdf98bdc.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/31.75fe6739.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/32.337bc2fe.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/33.16f0a82e.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/34.aeee2b94.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/35.92a761c4.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/36.650b0ab6.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/37.8b242734.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/38.b80c9e2e.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/39.da81b7e9.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/4.e53f978e.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/40.ad9db5cb.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/41.f061e6b8.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/42.fbb640da.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/43.5f1e180f.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/44.20c11a66.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/45.d518ff7d.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/46.64ca7118.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/47.33e40d0c.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/48.f4633edd.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/49.c3f73c13.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/5.b01a62a1.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/50.eefe5acf.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/51.10f537c8.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/52.c5e6db6a.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/53.b3f0289c.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/55.1095b46e.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/56.6dae4490.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/6.e6477448.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/7.5c8997e8.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/8.cc524ee6.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/9.f5f3bb57.js">
    <link rel="stylesheet" href="/OpenShift-on-SimpliVity/assets/css/0.styles.10caf491.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/OpenShift-on-SimpliVity/" class="home-link router-link-active"><!----> <span class="site-name">Red Hat OpenShift on HPE SimpliVity</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/OpenShift-on-SimpliVity/" class="nav-link">Home</a></div><div class="nav-item"><a href="/OpenShift-on-SimpliVity/blog/" class="nav-link">Blog</a></div> <a href="https://github.com/HewlettPackard/Openshift-on-Simplivity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/OpenShift-on-SimpliVity/" class="nav-link">Home</a></div><div class="nav-item"><a href="/OpenShift-on-SimpliVity/blog/" class="nav-link">Blog</a></div> <a href="https://github.com/HewlettPackard/Openshift-on-Simplivity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Release Notes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Preparing the environment</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Configuring the solution</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Overview of the playbooks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Post deployment tasks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Configuring storage</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Deploying worker nodes</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenShift-on-SimpliVity/worker-nodes/worker-intro.html" class="sidebar-link">Adding worker nodes</a></li><li><a href="/OpenShift-on-SimpliVity/worker-nodes/coreos.html" class="sidebar-link">Deploying CoreOS nodes</a></li><li><a href="/OpenShift-on-SimpliVity/worker-nodes/rhel.html" class="active sidebar-link">Deploying RHEL worker nodes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/OpenShift-on-SimpliVity/worker-nodes/rhel.html#system-requirements-for-rhel-compute-nodes" class="sidebar-link">System requirements for RHEL compute nodes</a></li><li class="sidebar-sub-header"><a href="/OpenShift-on-SimpliVity/worker-nodes/rhel.html#running-the-playbooks" class="sidebar-link">Running the playbooks</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deploying cluster logging</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Backup and restore</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Appendices</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="deploying-rhel-worker-nodes"><a href="#deploying-rhel-worker-nodes" aria-hidden="true" class="header-anchor">#</a> Deploying RHEL worker nodes</h1> <p>You can only deploy RHEL7 worker nodes after the OpenShift control plane has been successfully deployed and the OCP cluster is up and running.</p> <div class="warning custom-block"><p>If you choose to use RHEL compute machines in your cluster, you take responsibility for all operating system life cycle management and maintenance, including performing system updates, applying patches, and completing all other required tasks.</p></div> <div class="warning custom-block"><p>Only RHEL 7.6 is supported in OpenShift Container Platform 4.1. You must not upgrade your compute machines to RHEL 8.</p></div> <h2 id="system-requirements-for-rhel-compute-nodes"><a href="#system-requirements-for-rhel-compute-nodes" aria-hidden="true" class="header-anchor">#</a> System requirements for RHEL compute nodes</h2> <p>The Red Hat Enterprise Linux (RHEL) compute, or worker, machine hosts in your OpenShift Container Platform environment must meet the following minimum hardware specifications and system-level requirements.</p> <ul><li><p>You must have an active OpenShift Container Platform subscription on your Red Hat account.</p></li> <li><p>Production environments must provide compute machines to support your expected workloads. As an OpenShift Container Platform cluster administrator, you must calculate the expected workload and add about 10 percent for overhead. For production environments, allocate enough resources so that a node host failure does not affect your maximum capacity.</p></li></ul> <h2 id="running-the-playbooks"><a href="#running-the-playbooks" aria-hidden="true" class="header-anchor">#</a> Running the playbooks</h2> <p>There are two distinct steps for deploying RHEL worker nodes.</p> <ul><li>Download Red Hat Ansible playbooks to the folder <code>~/openshift-ansible</code> folder</li> <li>Run the HPE playbook <code>playbooks/scale.yml</code> in the <code>~/Openshift-on-SimpliVity</code> to provision the RHEL VMs</li> <li>Run the Red Hat Ansible playbook  to add the RHEL nodes to the OCP cluster.</li></ul> <h3 id="download-red-hat-ansible-playbooks"><a href="#download-red-hat-ansible-playbooks" aria-hidden="true" class="header-anchor">#</a> Download Red Hat Ansible playbooks</h3> <p>The required  Red Hat <code>openshift-ansible</code> playbooks change regularly. HPE has no control on these playbooks and therefore recommends that you use a specific version of the playbooks rather than the latest version  on the master branch. At the time of  writing, the <code>4.1.11-201908060314</code> version of the Red Hat <code>openshift-ansible</code> playbooks  have been tested and certified with this solution.</p> <p>Clone the <code>4.1.11-201908060314</code> branch of the <code>openshift-ansible</code> playbooks into the home directory of the <code>core</code> user on the Ansible controller node:</p> <div class="language- extra-class"><pre class="language-text"><code>git clone --branch openshift-ansible-4.1.11-201908060314 https://github.com/openshift/openshift-ansible.git
</code></pre></div><p>Ensure that the <code>ocp_repo_directory</code> variable in <code>group_vars/all/vars.yml</code> accurately reflects the location of the cloned  <code>openshift-ansible</code> playbooks. By default, this parameter is set to: <code>&lt;&lt;local_home&gt;&gt;/openshift-ansible</code> so it should not require modification if the playbooks were cloned in the <code>core</code> user's home directory.</p> <h3 id="running-playbooks-scale-yml-to-provision-the-rhel-vms"><a href="#running-playbooks-scale-yml-to-provision-the-rhel-vms" aria-hidden="true" class="header-anchor">#</a> Running playbooks/scale.yml to provision the RHEL VMs</h3> <ul><li><p>Modify your <code>hosts</code> inventory file to add one or more entries in  the <code>[rhel_worker]</code> group. For example, in the extract from the  <code>hosts</code> file below,  the <code>ocp-worker4</code> node will be added as a RHEL7 worker:</p> <div class="language- extra-class"><pre class="language-text"><code>[rhcos_worker]
ocp-worker0   ansible_host=10.15.155.213 
ocp-worker1   ansible_host=10.15.155.214
ocp-worker2   ansible_host=10.15.155.215 
ocp-worker3   ansible_host=10.15.155.216 

[rhel_worker]
ocp-worker4   ansible_host=10.15.155.217
</code></pre></div></li> <li><p>Ensure that the value of the  <code>template</code> variable in the group variables file <code>group_vars/rhel_worker.yml</code> is  set to the name of your RHEL 7.6 template. Alternatively, set the <code>ova_path</code> variable in the same group file to the location of your RHEL 7.6 OVA file. The <code>template</code> variable will take precedence over the <code>ova_path</code> variable if both are present.</p> <div class="language- extra-class"><pre class="language-text"><code>template: hpe-rhel760              # Override the default template
ova_path: /kits/hpe-rhel760.ova    # Name of the OVA used to import the template
</code></pre></div></li> <li><p>Run the playbooks/scale.yml file</p> <div class="language- extra-class"><pre class="language-text"><code>cd ~/Openshift-on-SimpliVity
ansible-playbook -i hosts playbooks/scale.yml --vault-password-file .vault_pass
</code></pre></div></li></ul> <p>Running this playbook will generate an inventory file called <code>inventory.scale</code> in the  <code>~/openshift-ansible</code> folder, so that folder must be present before running the <code>playbooks/scale.yml</code> playbook.</p> <h3 id="run-the-red-hat-ansible-playbook-scaleup-yml"><a href="#run-the-red-hat-ansible-playbook-scaleup-yml" aria-hidden="true" class="header-anchor">#</a> Run the Red Hat Ansible playbook <code>scaleup.yml</code></h3> <p>Deploy the RHEL7 worker node(s) by invoking the <code>playbooks/scaleup.yml</code> playbook in the <code>openshift-ansible</code> directory:</p> <div class="language- extra-class"><pre class="language-text"><code>cd ~/openshift-ansible
ansible-playbook -i inventory.scale playbooks/scaleup.yml
</code></pre></div><p>Verify the newly created RHEL7 worker node <code>ocp-worker4</code> has joined the cluster:</p> <div class="language- extra-class"><pre class="language-text"><code>oc get nodes -o wide
NAME          STATUS   ROLES    AGE    VERSION             INTERNAL-IP     EXTERNAL-IP     OS-IMAGE                                                   KERNEL-VERSION               CONTAINER-RUNTIME
ocp-master0   Ready    master   10d    v1.13.4+9252851b0   10.15.155.210   10.15.155.210   Red Hat Enterprise Linux CoreOS 410.8.20190612.0 (Ootpa)   4.18.0-80.1.2.el8_0.x86_64   cri-o://1.13.9-1.rhaos4.1.gitd70609a.el8
ocp-master1   Ready    master   10d    v1.13.4+9252851b0   10.15.155.211   10.15.155.211   Red Hat Enterprise Linux CoreOS 410.8.20190612.0 (Ootpa)   4.18.0-80.1.2.el8_0.x86_64   cri-o://1.13.9-1.rhaos4.1.gitd70609a.el8
ocp-master2   Ready    master   10d    v1.13.4+9252851b0   10.15.155.212   10.15.155.212   Red Hat Enterprise Linux CoreOS 410.8.20190612.0 (Ootpa)   4.18.0-80.1.2.el8_0.x86_64   cri-o://1.13.9-1.rhaos4.1.gitd70609a.el8
ocp-worker0   Ready    worker   10d    v1.13.4+9252851b0   10.15.155.213   10.15.155.213   Red Hat Enterprise Linux CoreOS 410.8.20190612.0 (Ootpa)   4.18.0-80.1.2.el8_0.x86_64   cri-o://1.13.9-1.rhaos4.1.gitd70609a.el8
ocp-worker1   Ready    worker   10d    v1.13.4+9252851b0   10.15.155.214   10.15.155.214   Red Hat Enterprise Linux CoreOS 410.8.20190612.0 (Ootpa)   4.18.0-80.1.2.el8_0.x86_64   cri-o://1.13.9-1.rhaos4.1.gitd70609a.el8
ocp-worker2   Ready    worker   8d     v1.13.4+9252851b0   10.15.155.215   10.15.155.215   Red Hat Enterprise Linux CoreOS 410.8.20190612.0 (Ootpa)   4.18.0-80.1.2.el8_0.x86_64   cri-o://1.13.9-1.rhaos4.1.gitd70609a.el8
ocp-worker3   Ready    worker   8d     v1.13.4+9252851b0   10.15.155.216   10.15.155.216   Red Hat Enterprise Linux CoreOS 410.8.20190612.0 (Ootpa)   4.18.0-80.1.2.el8_0.x86_64   cri-o://1.13.9-1.rhaos4.1.gitd70609a.el8
ocp-worker4   Ready    worker   7d3h   v1.13.4+509f0153f   10.15.155.217   10.15.155.217   OpenShift Enterprise                                       3.10.0-957.21.3.el7.x86_64   cri-o://1.13.9-1.rhaos4.1.gitd70609a.el7

</code></pre></div><p><em><strong>Note:</strong></em> It can take 10 to 15 minutes to deploy two Red Hat Enterprise Linux worker nodes.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Openshift-on-Simplivity/edit/master/docs-src/worker-nodes/rhel.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/OpenShift-on-SimpliVity/worker-nodes/coreos.html" class="prev">
          Deploying CoreOS nodes
        </a></span> <span class="next"><a href="/OpenShift-on-SimpliVity/logging/logging-intro.html">
          Introduction to central logging
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/OpenShift-on-SimpliVity/assets/js/app.40e23d52.js" defer></script><script src="/OpenShift-on-SimpliVity/assets/js/2.1dbc2e0f.js" defer></script><script src="/OpenShift-on-SimpliVity/assets/js/54.2f275aa2.js" defer></script>
  </body>
</html>
