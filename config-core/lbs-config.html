<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Load balancer configuration | Red Hat OpenShift Container Platform on HPE SimpliVity</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/OpenShift-on-SimpliVity/assets/css/0.styles.4f7eb8c7.css" as="style"><link rel="preload" href="/OpenShift-on-SimpliVity/assets/js/app.811ef61c.js" as="script"><link rel="preload" href="/OpenShift-on-SimpliVity/assets/js/3.3f5e626f.js" as="script"><link rel="preload" href="/OpenShift-on-SimpliVity/assets/js/22.3ef2b178.js" as="script"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/10.4011deca.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/11.7fac75ed.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/12.67123e89.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/13.1f76ec03.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/14.17575cf3.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/15.5e7c0fa2.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/16.c87acd79.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/17.4a51758a.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/18.1e30e963.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/19.e55ee070.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/20.b4cfe23f.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/21.41fb2f50.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/23.18e75c16.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/24.2bfe34b9.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/25.bf8c446c.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/26.87297fee.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/27.f68ee975.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/28.6f79456a.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/29.15de2672.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/30.e289fa4c.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/31.40758a1e.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/32.4ebd0395.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/33.86dcbd08.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/34.5e5987a5.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/35.26cb660b.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/36.4e50aa53.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/37.31c028ad.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/38.24d88841.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/39.74e3dd11.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/4.b91c4aca.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/40.3b833fb1.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/41.8f7ce778.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/42.e9a08f05.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/43.e1d8a8fa.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/44.89cee94f.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/45.3557666f.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/46.5ff057ae.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/47.00d0c323.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/48.10d10424.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/49.6f7ff133.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/5.8315f23f.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/50.343f157b.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/51.723e6a02.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/52.c5330671.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/53.e9e4563b.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/54.47e74543.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/55.dae1c615.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/56.f51a3982.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/57.aedd490f.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/58.38ca2414.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/59.cfe09a1b.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/6.63b20584.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/60.e7b3e7ca.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/61.0f38a2e7.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/62.666356ce.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/63.0f85f197.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/64.3a80ab5b.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/65.397d4c1a.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/66.5226db23.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/67.b9b85faf.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/68.0c4cd19c.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/69.db6adde9.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/7.b3e6d1ef.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/70.2f12ca1d.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/8.608d9cde.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/9.3866ee39.js"><link rel="prefetch" href="/OpenShift-on-SimpliVity/assets/js/vendors~docsearch.b912bd98.js">
    <link rel="stylesheet" href="/OpenShift-on-SimpliVity/assets/css/0.styles.4f7eb8c7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/OpenShift-on-SimpliVity/" class="home-link router-link-active"><!----> <span class="site-name">Red Hat OpenShift Container Platform on HPE SimpliVity</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/OpenShift-on-SimpliVity/" class="nav-link">Home</a></div><div class="nav-item"><a href="/OpenShift-on-SimpliVity/blog/" class="nav-link">Blog</a></div> <a href="https://github.com/HewlettPackard/OpenShift-on-SimpliVity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/OpenShift-on-SimpliVity/" class="nav-link">Home</a></div><div class="nav-item"><a href="/OpenShift-on-SimpliVity/blog/" class="nav-link">Blog</a></div> <a href="https://github.com/HewlettPackard/OpenShift-on-SimpliVity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/OpenShift-on-SimpliVity/executive-summary.html" class="sidebar-link">Executive Summary</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Release Notes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Preparing the environment</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Configuring the solution</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenShift-on-SimpliVity/config-core/ansible-config.html" class="sidebar-link">Ansible configuration</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/proxy-config.html" class="sidebar-link">Proxy configuration</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/edit-hosts.html" class="sidebar-link">Editing the hosts file</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/vmware-config.html" class="sidebar-link">VMware configuration</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/simplivity-config.html" class="sidebar-link">HPE SimpliVity configuration</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/networking-config.html" class="sidebar-link">Networking configuration</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/redhat-config.html" class="sidebar-link">Red Hat Network configuration</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/openshift-config.html" class="sidebar-link">OpenShift configuration</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/lbs-config.html" class="active sidebar-link">Load balancer configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/OpenShift-on-SimpliVity/config-core/lbs-config.html#quick-start" class="sidebar-link">Quick start</a></li><li class="sidebar-sub-header"><a href="/OpenShift-on-SimpliVity/config-core/lbs-config.html#deploying-two-load-balancers" class="sidebar-link">Deploying two load balancers</a></li><li class="sidebar-sub-header"><a href="/OpenShift-on-SimpliVity/config-core/lbs-config.html#deploying-one-load-balancer" class="sidebar-link">Deploying one load balancer</a></li><li class="sidebar-sub-header"><a href="/OpenShift-on-SimpliVity/config-core/lbs-config.html#using-your-own-load-balancers" class="sidebar-link">Using your own load balancers</a></li><li class="sidebar-sub-header"><a href="/OpenShift-on-SimpliVity/config-core/lbs-config.html#load-balancer-variables" class="sidebar-link">Load balancer variables</a></li></ul></li><li><a href="/OpenShift-on-SimpliVity/config-core/group-vars.html" class="sidebar-link">Inventory group variables</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/edit-vault.html" class="sidebar-link">Protecting sensitive information</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/vars-sample.html" class="sidebar-link">Sample vars file</a></li><li><a href="/OpenShift-on-SimpliVity/config-core/vault-sample.html" class="sidebar-link">Sample vault file</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Overview of the playbooks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Post deployment tasks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Configuring storage</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Adding worker nodes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deploying cluster logging</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Backup and restore</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Appendices</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="load-balancer-configuration"><a href="#load-balancer-configuration" aria-hidden="true" class="header-anchor">#</a> Load balancer configuration</h1> <p>The solution supports a number of load balancer configuration options:</p> <ul><li>Use the playbooks to configure two load balancers, for highly available, production deployments.</li> <li>Use the playbooks to configure a single load balancer, useful for proof of concept deployments.</li> <li>Deploy the solution using your own load balancers.</li></ul> <h2 id="quick-start"><a href="#quick-start" aria-hidden="true" class="header-anchor">#</a> Quick start</h2> <p>A sample configuration for deploying two load balancers is shown below. This extract from the Ansible <code>hosts</code>
inventory file shows the entries defining the nodes used for the load balancers:</p> <div class="language- extra-class"><pre class="language-text"><code>[loadbalancer]
ocp-lb1 ansible_host=10.15.155.7 frontend_ipaddr=10.15.156.40/24 api_int_preferred=
ocp-lb2 ansible_host=10.15.155.8 frontend_ipaddr=10.15.156.41/24 api_preferred=
</code></pre></div><p>This extract from the configuration file <code>group_vars/all/vars.yml</code> shows the networking configuration required for
the two load balancer scenario:</p> <div class="language- extra-class"><pre class="language-text"><code>frontend_vm_portgroup: 'extVLAN2968'
frontend_gateway: '10.15.156.1''

loadbalancers:
  apps:
    vip: 10.15.156.42/24
  backend:
    vip: 10.15.155.9/24
    interface: ens192
    vrrp_router_id: 54
  frontend:
    vip: 10.15.156.42/24
    interface: ens224
    vrrp_router_id: 54
</code></pre></div><p>This configuration will be expanded on in the following sections.</p> <h2 id="deploying-two-load-balancers"><a href="#deploying-two-load-balancers" aria-hidden="true" class="header-anchor">#</a> Deploying two load balancers</h2> <p>With this option, two load balancers are deployed in an active-active configuration to provide highly-available access.
These nodes run <code>keepalived</code> and <code>HAproxy</code>. The load balancers are hosted on two VMs that are prevented from running on
the same ESXi host through the use the following anti-affinity rule:</p> <div class="language- extra-class"><pre class="language-text"><code>{{cluster_name}}-loadbalancer-anti-affinity-rule-001
</code></pre></div><p>where <code>cluster_name</code> is defined in the configuration file <code>group_vars/all/vars.yml</code>.</p> <p>Two virtual machines are configured in the <code>hosts</code> inventory file, with each VM connected to an external (frontend)
network and an internal (backend) network. To achieve this, each load balancer must have two IP addresses specified,
one on the internal network using the <code>ansible_host</code> variable and a second address on the external network using
<code>frontend_ipaddr</code>. The latter should be specified in CIDR notation (for example <code>10.10.174.165/22</code>).
The internal network is determined by the <code>vm_portgroup</code> variable in your configuration file, while the external
network is set using the <code>frontend_vm_portgroup</code> variable.</p> <p>You configure one of the VMs as the preferred VM for hosting the internal VIP for the OCP API, by adding
<code>api_int_preferred=</code> to the definition. Similarly, you configure the other VM as the preferred VM for hosting
the external VIP for the OCP API by adding <code>api_preferred=</code> to the entry. Note that the <code>=</code> sign is required
for both settings. A sample <code>[loadbalancer]</code> group is shown below:</p> <div class="language- extra-class"><pre class="language-text"><code>[loadbalancer]
ocp-lb1 ansible_host=10.15.155.7 frontend_ipaddr=10.15.156.40/24 api_int_preferred=
ocp-lb2 ansible_host=10.15.155.8 frontend_ipaddr=10.15.156.41/24 api_preferred=
</code></pre></div><p>The following variables must also be declared in your configuration file <code>group_vars/all/vars.yml</code>. The frontend
network must be defined, similar to the example below:</p> <div class="language- extra-class"><pre class="language-text"><code>frontend_vm_portgroup: 'extVLAN2968' # Name of the portgroup / external network
frontend_gateway: '10.15.156.1'      # gateway for the external network
</code></pre></div><p>The <code>loadbalancers</code> variable in your configuration file <code>group_vars/all/vars.yml</code> is used to define the networking
configuration. A virtual IP (VIP) is specified for external access to applications, and for external (frontend) and
internal (backend) access to the OCP API. A sample <code>loadbalancers</code> definition is shown below:</p> <div class="language- extra-class"><pre class="language-text"><code>loadbalancers:
  apps:
    vip: 10.15.156.9/24
  backend:
    vip: 10.15.155.9/24
    interface: ens192
    vrrp_router_id: 51
  frontend:
    vip: 10.15.156.9/24
    interface: ens224
    vrrp_router_id: 51
</code></pre></div><p>The names of the interfaces are OS-dependent and depend on how the VMs are built. Using the playbooks from the
<code>OpenShift-on-SimpliVity</code> repository with Red Hat Enterprise 7.6, the values of <code>ens192</code> (backend) and <code>ens224</code>
(frontend) should be appropriate.  The <code>vrrp_router_id</code> is used to differentiate between multiple deployments
on the same networking infrastructure, for example, in proof of concepts. If you have multiple deployments, ensure that
each deployment uses unique VRRP router IDs.</p> <h2 id="deploying-one-load-balancer"><a href="#deploying-one-load-balancer" aria-hidden="true" class="header-anchor">#</a> Deploying one load balancer</h2> <p>If you do not require high availability, you can deploy a single load balancer to reduce complexity and resource
requirements. In this instance, you only specify a single entry in the <code>[loadbalancer]</code> group in your <code>hosts</code> file.
The load balancer must have two IP addresses specified, one on the internal network using the <code>ansible_host</code> variable and
a second address on the external network using <code>frontend_ipaddr</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>[loadbalancer]
ocp-lb1 ansible_host=10.15.155.7 frontend_ipaddr=10.15.156.7/24
</code></pre></div><p>The frontend network must be defined in your configuration file <code>group_vars/all/vars.yml</code>, similar to the example below:</p> <div class="language- extra-class"><pre class="language-text"><code>frontend_vm_portgroup: 'extVLAN2968' # Name of the portgroup / external network
frontend_gateway: '10.15.156.1'      # gateway for the external network
</code></pre></div><p>The definition for the <code>loadbalancers</code> variable is now simplified. No virtual IPs need to be specified. Instead, the two
IP addresses of the load balancer VM are now used. From the example <code>hosts</code> file, <code>10.15.155.7</code> is used for internal
access to the OCP API (from <code>ansible_host=10.15.155.7</code>) while <code>10.15.156.7</code> is used for external access (from
<code>frontend_ipaddr=10.15.156.7</code>).</p> <p>A sample <code>loadbalancers</code> definition is shown below:</p> <div class="language- extra-class"><pre class="language-text"><code>loadbalancers:
  apps:
  backend:
    interface: ens192
  frontend:
    interface: ens224
</code></pre></div><p>Once again, the names of the interfaces are OS-dependent and depend on how the VMs are built.
Using the playbooks from the <code>OpenShift-on-SimpliVity</code> repository with Red Hat Enterprise 7.6, the
values of <code>ens192</code> (backend) and <code>ens224</code> (frontend) should be appropriate.  The <code>vrrp_router_id</code> variable
is no longer needed in this instance.</p> <h2 id="using-your-own-load-balancers"><a href="#using-your-own-load-balancers" aria-hidden="true" class="header-anchor">#</a> Using your own load balancers</h2> <p>To use your own load balancers, you should delete any entries in the <code>[loadbalancer]</code> group in your <code>hosts</code> file.
Note that you must still include the <code>[loadbalancer]</code> group in the file. Your load balancers should be configured
to meet the requirements as specified in the OpenShift installation documentation
at <a href="https://docs.openshift.com/container-platform/4.2/installing/installing_vsphere/installing-vsphere.html" target="_blank" rel="noopener noreferrer">https://docs.openshift.com/container-platform/4.2/installing/installing_vsphere/installing-vsphere.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>The frontend network must be defined in your configuration file <code>group_vars/all/vars.yml</code>, similar to the example below:</p> <div class="language- extra-class"><pre class="language-text"><code>frontend_vm_portgroup: 'extVLAN2968' # Name of the portgroup / external network
frontend_gateway: '10.15.156.1'      # gateway for the external network
</code></pre></div><p>The definition for the <code>loadbalancers</code> variable is again simplified but this time you just specify the virtual IPs
to be used. A sample <code>loadbalancers</code> definition is shown below:</p> <div class="language- extra-class"><pre class="language-text"><code>loadbalancers:
  apps:
    vip: 10.15.156.9/24
  backend:
    vip: 10.15.155.9/24
  frontend:
    vip: 10.15.156.9/24
</code></pre></div><h2 id="load-balancer-variables"><a href="#load-balancer-variables" aria-hidden="true" class="header-anchor">#</a> Load balancer variables</h2> <p>The following table contains definitions for all the variables used when configuring your load balancers.</p> <table><thead><tr><th style="text-align:left;">Variable</th> <th style="text-align:left;">File</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>frontend_vm_portgroup</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Name of the portgroup connected to the access/public network</td></tr> <tr><td style="text-align:left;"><code>frontend_gateway</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Access network gateway</td></tr> <tr><td style="text-align:left;"><code>loadbalancers</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">A dictionary containing entries for <code>apps</code>, <code>backend</code> and <code>frontend</code></td></tr> <tr><td style="text-align:left;"><code>loadbalancers.apps</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">A dictionary containing entries specific to <code>apps</code> access</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.apps.vip</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">If ommited, defaults to the internal IP address of the first load balancer (ie no VIP, no HA)</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.backend</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">A dictionary containing entries specific to <code>backend</code> access</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.backend.vip</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">If ommited, defaults to the internal IP address of the first load balancer (ie no VIP, no HA)</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.backend.interface</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Name of the internal (backend) interface. For example, <code>ens192</code> if using RHEL 7.6 with these playbooks</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.backend.vrrp_router_id</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">If you are deploying multiple clusters in the same environment, it is important to keep them separated using distinct VRRP IDs</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.frontend</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">A dictionary containing entries specific to <code>frontend</code> access</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.frontend.vip</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">If omitted, defaults to the external IP address of the first load balancer (i.e. no VIP, no HA)</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.frontend.interface</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Name of the external (frontend) interface. For example, <code>ens224</code> if using RHEL 7.6 with these playbooks</td></tr> <tr><td style="text-align:left;"><code>loadbalancers.frontend.vrrp_router_id</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">If you are deploying multiple clusters in the same environment, it is important to keep them separated using distinct VRRP IDs</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/HewlettPackard/OpenShift-on-SimpliVity/edit/docs-dev/docs-src/config-core/lbs-config.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/OpenShift-on-SimpliVity/config-core/openshift-config.html" class="prev">OpenShift configuration</a></span> <span class="next"><a href="/OpenShift-on-SimpliVity/config-core/group-vars.html">Inventory group variables</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/OpenShift-on-SimpliVity/assets/js/app.811ef61c.js" defer></script><script src="/OpenShift-on-SimpliVity/assets/js/3.3f5e626f.js" defer></script><script src="/OpenShift-on-SimpliVity/assets/js/22.3ef2b178.js" defer></script>
  </body>
</html>
